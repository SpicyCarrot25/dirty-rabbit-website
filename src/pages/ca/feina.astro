---
import Layout from '../../layouts/Layout.astro';

const lang = 'ca';
---

<Layout title="Uneix-te a l'Equip â€” Dirty Rabbit" lang={lang}>
  <!-- Hero Section -->
  <section class="pt-8 pb-12 md:pt-12 md:pb-16 bg-cream">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h1 class="font-typewriter text-5xl md:text-6xl font-bold text-red mb-6">Uneix-te a Nosaltres</h1>
      <div class="w-16 h-px bg-red mx-auto mb-8"></div>
      <p class="font-mono text-lg text-black/70">
        T'apassiona el cafÃ¨? T'agraden els matins tranquils i la gent maca? 
        Sempre busquem persones que vulguin formar part de DR.
      </p>
    </div>
  </section>

  <!-- Form Section -->
  <section class="py-12 md:py-16 bg-white">
    <div class="max-w-xl mx-auto px-4 sm:px-6 lg:px-8">
      
      <form id="join-form" class="space-y-6">
        <!-- Name -->
        <div>
          <label for="name" class="block font-typewriter text-lg font-bold mb-2">El teu nom</label>
          <input 
            type="text" 
            id="name" 
            name="name"
            required
            class="w-full border border-black/20 rounded-lg px-4 py-3 font-mono text-base focus:outline-none focus:border-red transition-colors"
            placeholder="Com et diem?"
          />
        </div>

        <!-- Email -->
        <div>
          <label for="email" class="block font-typewriter text-lg font-bold mb-2">Email</label>
          <input 
            type="email" 
            id="email" 
            name="email"
            required
            class="w-full border border-black/20 rounded-lg px-4 py-3 font-mono text-base focus:outline-none focus:border-red transition-colors"
            placeholder="Per contestar-te"
          />
        </div>

        <!-- Message -->
        <div>
          <label for="message" class="block font-typewriter text-lg font-bold mb-2">Explica'ns de tu</label>
          <textarea 
            id="message" 
            name="message"
            rows="4"
            required
            class="w-full border border-black/20 rounded-lg px-4 py-3 font-mono text-base focus:outline-none focus:border-red transition-colors resize-none"
            placeholder="QuÃ¨ et porta per aquÃ­? Tens experiÃ¨ncia? T'agrada mÃ©s el cafÃ¨ o el te?"
          ></textarea>
        </div>

        <!-- Phone (optional) -->
        <div>
          <label for="phone" class="block font-typewriter text-lg font-bold mb-2">
            TelÃ¨fon <span class="font-mono text-sm font-normal text-black/50">(opcional)</span>
          </label>
          <div class="flex gap-2">
            <select 
              id="country" 
              name="country"
              class="w-28 border border-black/20 rounded-lg px-3 py-3 font-mono text-base focus:outline-none focus:border-red transition-colors bg-white"
            >
              <option value="+34">ðŸ‡ªðŸ‡¸ +34</option>
              <option value="+33">ðŸ‡«ðŸ‡· +33</option>
              <option value="+44">ðŸ‡¬ðŸ‡§ +44</option>
              <option value="+49">ðŸ‡©ðŸ‡ª +49</option>
              <option value="+39">ðŸ‡®ðŸ‡¹ +39</option>
              <option value="+351">ðŸ‡µðŸ‡¹ +351</option>
              <option value="+31">ðŸ‡³ðŸ‡± +31</option>
              <option value="+48">ðŸ‡µðŸ‡± +48</option>
              <option value="+380">ðŸ‡ºðŸ‡¦ +380</option>
              <option value="+7">ðŸ‡·ðŸ‡º +7</option>
              <option value="+1">ðŸ‡ºðŸ‡¸ +1</option>
            </select>
            <input 
              type="tel" 
              id="phone" 
              name="phone"
              class="flex-1 border border-black/20 rounded-lg px-4 py-3 font-mono text-base focus:outline-none focus:border-red transition-colors"
              placeholder="612 345 678"
            />
          </div>
        </div>

        <!-- Submit -->
        <button 
          type="submit"
          class="w-full bg-red text-cream font-typewriter font-bold text-lg px-8 py-4 rounded-lg hover:bg-red/90 transition-colors"
        >
          Enviar SolÂ·licitud
        </button>
        
        <!-- Success message -->
        <p id="form-success" class="hidden text-center font-mono text-green-600">
          âœ“ Rebut! Et escrivim aviat.
        </p>
        
        <!-- Error message -->
        <p id="form-error" class="hidden text-center font-mono text-red">
          Alguna cosa ha fallat. Escriu-nos a hola@dirtyrabbit.es
        </p>
      </form>
      
    </div>
  </section>
</Layout>

<script>
  const form = document.getElementById('join-form');
  const successMsg = document.getElementById('form-success');
  const errorMsg = document.getElementById('form-error');
  
  if (form) {
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const formData = new FormData(form as HTMLFormElement);
      const data = Object.fromEntries(formData.entries());
      
      try {
        const applications = JSON.parse(localStorage.getItem('dr_applications') || '[]');
        applications.push({ ...data, submitted_at: new Date().toISOString() });
        localStorage.setItem('dr_applications', JSON.stringify(applications));
        
        (form as HTMLFormElement).classList.add('hidden');
        successMsg?.classList.remove('hidden');
      } catch (err) {
        errorMsg?.classList.remove('hidden');
      }
    });
  }
</script>
