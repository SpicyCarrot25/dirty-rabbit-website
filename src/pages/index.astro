---
import Layout from '../layouts/Layout.astro';
import { getTranslations, getLocalizedPath } from '../i18n';
import proveedores from '../data/proveedores.json';

const lang = 'es';
const t = getTranslations(lang);

// First 4 providers for homepage
const featuredProviders = proveedores.slice(0, 4);
---

<Layout title="Dirty Rabbit — Specialty Coffee, Breakfast & Brunch · S'Agaró" lang={lang}>
  
  <!-- HERO SECTION: 100vh, full-bleed photo, centered tagline, NO scroll indicator -->
  <section class="relative h-screen flex items-center justify-center overflow-hidden -mt-16 md:-mt-20">
    <!-- Background: Full-bleed photo placeholder -->
    <div class="absolute inset-0 bg-black" id="hero-bg">
      <!-- TODO: Replace with real editorial-style photo -->
      <div class="absolute inset-0 flex items-center justify-center">
        <img 
          src="/logos/SIMBOLO-CREMA-DIRTYRABBIT.png" 
          alt="" 
          class="w-48 md:w-64 opacity-10"
          aria-hidden="true"
        />
      </div>
      <!-- Dark overlay for text readability -->
      <div class="absolute inset-0 bg-black/40"></div>
      <!-- Placeholder label -->
      <div class="absolute top-4 left-4 font-mono text-xs text-white/30 uppercase tracking-wider">
        [PHOTO TBD]
      </div>
    </div>
    
    <!-- Hero Content: Centered tagline only -->
    <div class="relative z-10 text-center text-white px-6 max-w-4xl mx-auto">
      <p class="reveal font-typewriter text-2xl md:text-4xl lg:text-5xl leading-relaxed hero-text-shadow">
        A place to wake up.<br class="hidden sm:block" /> 
        Or slow down.<br class="hidden sm:block" /> 
        Ideally both.
      </p>
    </div>
    
    <!-- No scroll indicator per design spec -->
  </section>
  
  
  <!-- COMMUNITY SECTION: Post-hero, no headline, elegant typography -->
  <section class="py-20 md:py-32 bg-white">
    <div class="max-w-4xl mx-auto px-6 text-center">
      <p class="reveal font-typewriter text-xl md:text-2xl lg:text-3xl leading-relaxed text-black/80">
        The family with the noisy kid. The remote worker with the dying laptop. The retired couple who've been coming since week one. The expat who just moved and doesn't know anyone yet. Strangers become regulars become friends.
      </p>
    </div>
  </section>
  
  
  <!-- PROVIDERS: 4 cards grid, same style as news cards -->
  <section class="py-20 md:py-32 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      
      <!-- Section Header -->
      <div class="text-center mb-12 md:mb-16 reveal">
        <h2 class="font-typewriter text-5xl md:text-6xl lg:text-7xl mb-4 section-headline">
          Proveedores
        </h2>
        <p class="font-mono text-sm text-black/60 max-w-xl mx-auto uppercase tracking-wider">
          La gente detrás de tu taza
        </p>
      </div>
      
      <!-- Horizontal Slider (same as News) -->
      <div class="news-slider -mx-4 px-4 md:mx-0 md:px-0">
        {featuredProviders.map((p) => (
          <article class="reveal card-lift bg-cream border border-[#1A1A1A] rounded-xl overflow-hidden w-[80vw] md:w-[calc(33.333%-1rem)] max-w-[380px]">
            <div class="aspect-square bg-white relative overflow-hidden">
              <img 
                src="/logos/SIMBOLO-ROJO-DIRTYRABBIT.png" 
                alt="" 
                class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-20 opacity-10"
                aria-hidden="true"
              />
              <span class="absolute top-4 left-4 font-mono text-xs text-black/30 tracking-wider">
                [Photo tbd]
              </span>
            </div>
            <div class="p-6">
              <p class="font-mono text-xs text-red tracking-wider mb-2">
                {(p.category as any)[lang]}
              </p>
              <h3 class="font-typewriter text-xl md:text-2xl mb-2 text-black">
                {p.name}
              </h3>
              <p class="font-mono text-sm text-black/60">
                {p.origin ? `${p.origin}` : ''}
              </p>
            </div>
          </article>
        ))}
      </div>
      
      <!-- View All Link -->
      <div class="text-center mt-12 reveal">
        <a 
          href={getLocalizedPath('/proveedores', lang)}
          class="inline-flex items-center gap-2 font-typewriter text-red hover:text-red/80 transition-colors group"
        >
          Ver todos los proveedores
          <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>
      
    </div>
  </section>
  
  
  <!-- NEWS CARDS: Cream background, horizontal slider (Big Mamma style) -->
  <section class="py-20 md:py-32 bg-cream">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      
      <!-- Section Header - Large title hierarchy (Basora style) -->
      <div class="text-center mb-12 md:mb-16 reveal">
        <h2 class="font-typewriter text-5xl md:text-6xl lg:text-7xl mb-4 section-headline">
          News
        </h2>
        <p class="font-mono text-sm text-black/60 max-w-xl mx-auto uppercase tracking-wider">
          Lo que está pasando en el conejo
        </p>
      </div>
      
      <!-- Horizontal Slider -->
      <div class="news-slider -mx-4 px-4 md:mx-0 md:px-0">
        
        <!-- Card 1 -->
        <article class="reveal card-lift bg-white border border-[#1A1A1A] rounded-xl overflow-hidden w-[80vw] md:w-[calc(33.333%-1rem)] max-w-[380px]">
          <div class="aspect-square bg-cream relative overflow-hidden">
            <img 
              src="/logos/SIMBOLO-ROJO-DIRTYRABBIT.png" 
              alt="" 
              class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-20 opacity-10"
              aria-hidden="true"
            />
            <span class="absolute top-4 left-4 font-mono text-xs text-black/30 tracking-wider">
              [Photo tbd]
            </span>
          </div>
          <div class="p-6">
            <time class="font-mono text-xs text-red tracking-wider">
              Feb 2026
            </time>
            <h3 class="font-typewriter text-xl md:text-2xl mt-3 mb-2 text-black">
              Nuevo menú de primavera
            </h3>
            <p class="font-mono text-sm text-black/60 line-clamp-2">
              Platos frescos con producto de temporada de nuestros proveedores locales.
            </p>
          </div>
        </article>
        
        <!-- Card 2 -->
        <article class="reveal card-lift bg-white border border-[#1A1A1A] rounded-xl overflow-hidden w-[80vw] md:w-[calc(33.333%-1rem)] max-w-[380px]">
          <div class="aspect-square bg-cream relative overflow-hidden">
            <img 
              src="/logos/SIMBOLO-ROJO-DIRTYRABBIT.png" 
              alt="" 
              class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-20 opacity-10"
              aria-hidden="true"
            />
            <span class="absolute top-4 left-4 font-mono text-xs text-black/30 tracking-wider">
              [Photo tbd]
            </span>
          </div>
          <div class="p-6">
            <time class="font-mono text-xs text-red tracking-wider">
              Ene 2026
            </time>
            <h3 class="font-typewriter text-xl md:text-2xl mt-3 mb-2 text-black">
              Colaboración con La Cabra
            </h3>
            <p class="font-mono text-sm text-black/60 line-clamp-2">
              Tostadores de Copenhagen, ahora nuestro café house blend.
            </p>
          </div>
        </article>
        
        <!-- Card 3 -->
        <article class="reveal card-lift bg-white border border-[#1A1A1A] rounded-xl overflow-hidden w-[80vw] md:w-[calc(33.333%-1rem)] max-w-[380px]">
          <div class="aspect-square bg-cream relative overflow-hidden">
            <img 
              src="/logos/SIMBOLO-ROJO-DIRTYRABBIT.png" 
              alt="" 
              class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-20 opacity-10"
              aria-hidden="true"
            />
            <span class="absolute top-4 left-4 font-mono text-xs text-black/30 tracking-wider">
              [Photo tbd]
            </span>
          </div>
          <div class="p-6">
            <time class="font-mono text-xs text-red tracking-wider">
              Dic 2025
            </time>
            <h3 class="font-typewriter text-xl md:text-2xl mt-3 mb-2 text-black">
              Abrimos en S'Agaró
            </h3>
            <p class="font-mono text-sm text-black/60 line-clamp-2">
              Después de meses de trabajo, el conejo ha encontrado su madriguera.
            </p>
          </div>
        </article>
        
      </div>
      
      <!-- View All Link -->
      <div class="text-center mt-12 reveal">
        <a 
          href={getLocalizedPath('/news', lang)}
          class="inline-flex items-center gap-2 font-typewriter text-red hover:text-red/80 transition-colors group"
        >
          Ver todas las noticias
          <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>
      
    </div>
  </section>
  
  
  <!-- LOCATION: White background, info only (no map) -->
  <section class="py-20 md:py-32 bg-white">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      
      <!-- Top divider -->
      <div class="border-t border-[#1A1A1A] mb-12 md:mb-16"></div>
      
      <!-- Section Header -->
      <div class="text-center mb-12 md:mb-16 reveal">
        <h2 class="font-typewriter text-3xl md:text-4xl lg:text-5xl mb-4 section-headline">
          {t.sections.contact}
        </h2>
      </div>
      
      <div class="grid md:grid-cols-3 gap-8 lg:gap-12 text-center">
        
        <!-- Address -->
        <div class="reveal">
          <h3 class="font-typewriter text-lg mb-3 text-black">
            Dirección
          </h3>
          <address class="font-mono text-base text-black/70 not-italic leading-relaxed">
            {t.footer.address}<br />
            {t.footer.city}
          </address>
        </div>
        
        <!-- Hours -->
        <div class="reveal">
          <h3 class="font-typewriter text-lg mb-3 text-black">
            Horario
          </h3>
          <div class="font-mono text-base text-black/70 space-y-1">
            <p>{t.footer.hours}</p>
            <p class="text-red">{t.footer.closed}</p>
          </div>
        </div>
        
        <!-- Contact -->
        <div class="reveal">
          <h3 class="font-typewriter text-lg mb-3 text-black">
            Contacto
          </h3>
          <div class="font-mono text-base space-y-2">
            <p>
              <a 
                href="mailto:hola@dirtyrabbit.es" 
                class="text-black/70 hover:text-red transition-colors"
              >
                {t.footer.email}
              </a>
            </p>
            <p>
              <a 
                href="https://instagram.com/dirtyrabbitsagaro" 
                target="_blank"
                rel="noopener noreferrer"
                class="text-black/70 hover:text-red transition-colors"
              >
                @dirtyrabbitsagaro
              </a>
            </p>
          </div>
        </div>
        
      </div>
    </div>
  </section>
  
</Layout>

<script>
  // Fade-in on scroll - Vanilla JS with IntersectionObserver
  document.addEventListener('DOMContentLoaded', () => {
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    
    if (prefersReducedMotion) {
      // Show all elements immediately if reduced motion preferred
      document.querySelectorAll('.reveal').forEach(el => {
        el.classList.add('visible');
      });
      return;
    }
    
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry, index) => {
          if (entry.isIntersecting) {
            // Stagger the animation slightly
            setTimeout(() => {
              entry.target.classList.add('visible');
            }, index * 100);
            observer.unobserve(entry.target);
          }
        });
      },
      {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      }
    );
    
    document.querySelectorAll('.reveal').forEach(el => {
      observer.observe(el);
    });
    
    // Simple parallax for hero background
    const heroBg = document.getElementById('hero-bg');
    if (heroBg) {
      let ticking = false;
      
      window.addEventListener('scroll', () => {
        if (!ticking) {
          window.requestAnimationFrame(() => {
            const scrolled = window.pageYOffset;
            const rate = scrolled * 0.3;
            heroBg.style.transform = `translateY(${rate}px)`;
            ticking = false;
          });
          ticking = true;
        }
      });
    }
  });
</script>
