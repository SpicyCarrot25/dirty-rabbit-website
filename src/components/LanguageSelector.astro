---
import { languages, getLocalizedPath, type Language } from '../i18n';

interface Props {
  lang: Language;
}

const { lang } = Astro.props;

// Get current path without language prefix
const currentPath = Astro.url.pathname.replace(/^\/(en|ca)\//, '/').replace(/^\/(en|ca)$/, '/');

const langNames: Record<Language, string> = {
  es: 'ES',
  en: 'EN',
  ca: 'CA'
};
---

<!-- Simple inline language switcher - no dropdown, all options visible -->
<div class="flex items-center gap-1">
  {languages.map((l, i) => (
    <>
      <a 
        href={getLocalizedPath(currentPath, l)}
        class:list={[
          "font-mono text-sm px-2 py-1 rounded transition-colors",
          l === lang 
            ? "text-red font-bold" 
            : "text-black/60 hover:text-black active:text-red"
        ]}
        data-lang={l}
      >
        {langNames[l]}
      </a>
      {i < languages.length - 1 && <span class="text-black/30">|</span>}
    </>
  ))}
</div>

<script>
  // Save language preference on click
  document.querySelectorAll('[data-lang]').forEach(link => {
    link.addEventListener('click', () => {
      const lang = link.getAttribute('data-lang');
      if (lang) {
        localStorage.setItem('preferredLang', lang);
      }
    });
  });
</script>
